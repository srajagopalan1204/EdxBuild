<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>OPS – Shipping Feedback SOP – Knowledge Check</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 1.5rem;
      line-height: 1.5;
      background: #f7f7fb;
    }
    h1, h2 {
      color: #111827;
    }
    .meta {
      margin-bottom: 1rem;
      padding: 0.75rem 1rem;
      background: #e5e7eb;
      border-radius: 6px;
    }
    .question {
      margin-bottom: 1.75rem;
      padding: 1rem 1.25rem;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    }
    .q-text {
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    label {
      display: block;
      margin: 0.15rem 0;
    }
    button {
      margin-top: 0.4rem;
      margin-right: 0.4rem;
      padding: 0.3rem 0.75rem;
      border-radius: 4px;
      border: 1px solid #4b5563;
      background: #111827;
      color: #ffffff;
      cursor: pointer;
      font-size: 0.9rem;
    }
    button.secondary {
      background: #ffffff;
      color: #111827;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .feedback {
      margin-top: 0.4rem;
      font-size: 0.85rem;
      color: #065f46;
    }
    .feedback.error {
      color: #b91c1c;
    }
    #scoreSummary {
      font-weight: 600;
      margin-top: 0.5rem;
      margin-bottom: 0.75rem;
    }
    .footer-actions {
      margin-top: 1.5rem;
      padding-top: 1rem;
      border-top: 1px solid #d1d5db;
    }
    input[type="text"], input[type="email"] {
      padding: 0.25rem 0.4rem;
      margin-right: 0.5rem;
      border-radius: 4px;
      border: 1px solid #9ca3af;
    }
  </style>
</head>
<body>
  <h1>OPS – Shipping Feedback SOP – Knowledge Check</h1>

  <div class="meta">
    <p>
      Please complete this quiz after you have gone through the
      <strong>OPS – Shipping Feedback</strong> SOP module (M1 – Shipping Feedback at
      Scott Electric Electrical Distribution).
      You may answer each question up to <strong>two times</strong>. Your attempts and timestamps
      will be captured in a CSV log you can download at the end.
    </p>
    <p>
      <em>Note:</em> Question 1 is about the history and role of Scott Electric.
      Questions 2–10 are about the Shipping Feedback process steps
      S1–S10 and decisions D1–D2. :contentReference[oaicite:1]{index=1}
    </p>
  </div>

  <section>
    <h2>Learner Information</h2>
    <p>
      <label>
        Your Name:
        <input type="text" id="learnerName" placeholder="Type your name">
      </label>
      <label>
        Your Email:
        <input type="email" id="learnerEmail" placeholder="name@example.com">
      </label>
    </p>
  </section>

  <section id="quiz">
    <h2>Quiz Questions</h2>

    <!-- Q1 – Scott Electric history -->
    <div class="question" data-qid="q1">
      <p class="q-text">
        <strong>Q1.</strong> Which statement best describes Scott Electric’s history and role
        in the markets it serves?
      </p>
      <label><input type="radio" name="q1" value="0">
        A. Scott Electric is a new startup founded in the last few years that only serves one small town.</label>
      <label><input type="radio" name="q1" value="1">
        B. Scott Electric is a long-established regional wholesale electrical distributor headquartered in western Pennsylvania, with multiple branches and divisions serving customers in several states.</label>
      <label><input type="radio" name="q1" value="2">
        C. Scott Electric is a software company that only provides online ordering systems to other distributors.</label>
      <label><input type="radio" name="q1" value="3">
        D. Scott Electric is a small residential electrical contractor with no distribution operations.</label>
      <div>
        <button type="button" onclick="submitQuestion('q1')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q1')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q1"></div>
    </div>

    <!-- Q2 – Purpose of Shipping Feedback -->
    <div class="question" data-qid="q2">
      <p class="q-text">
        <strong>Q2.</strong> What is the main purpose of the
        <em>Shipping Feedback</em> SOP at Scott Electric?
      </p>
      <label><input type="radio" name="q2" value="0">
        A. To manage how pick tickets are printed in the warehouse.</label>
      <label><input type="radio" name="q2" value="1">
        B. To record what is actually shipping on each order (quantities, serial/lot numbers, items flagged for physical count, and any add-ons) so that inventory, paperwork, and future invoicing match the physical shipment.</label>
      <label><input type="radio" name="q2" value="2">
        C. To maintain the selling price list for all branches.</label>
      <label><input type="radio" name="q2" value="3">
        D. To track only returns and credit memos.</label>
      <div>
        <button type="button" onclick="submitQuestion('q2')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q2')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q2"></div>
    </div>

    <!-- Q3 – Early steps S1–S3 -->
    <div class="question" data-qid="q3">
      <p class="q-text">
        <strong>Q3.</strong> Which sequence best describes the first three steps in the
        Shipping Feedback SOP? :contentReference[oaicite:2]{index=2}
      </p>
      <label><input type="radio" name="q3" value="0">
        A. S1 – Enter quantity to be shipped &rarr; S2 – Flag product to be counted &rarr; S3 – Print shipping documents.</label>
      <label><input type="radio" name="q3" value="1">
        B. S1 – Enter or search for order # &rarr; S2 – Review the details on the order &rarr; S3 – Enter quantity to be shipped.</label>
      <label><input type="radio" name="q3" value="2">
        C. S1 – Ship the order &rarr; S2 – Complete the Shipping Feedback Detail &rarr; S3 – Apply add-ons.</label>
      <label><input type="radio" name="q3" value="3">
        D. S1 – Run invoice processing &rarr; S2 – Invoice to customer &rarr; S3 – DQT proof of delivery.</label>
      <div>
        <button type="button" onclick="submitQuestion('q3')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q3')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q3"></div>
    </div>

    <!-- Q4 – Serial/Lot decision D1 -->
    <div class="question" data-qid="q4">
      <p class="q-text">
        <strong>Q4.</strong> Decision D1 asks “Serial or Lot Controlled Product?”.
        If the answer is <em>Yes</em>, what must be done before completing shipping feedback?
      </p>
      <label><input type="radio" name="q4" value="0">
        A. Skip the serial/lot information and ship based on quantity only.</label>
      <label><input type="radio" name="q4" value="1">
        B. Drill into the line-item details (S5) and enter or select the correct serial or lot numbers (S6) for the product being shipped.</label>
      <label><input type="radio" name="q4" value="2">
        C. Cancel the order and ask the customer to place a new one.</label>
      <label><input type="radio" name="q4" value="3">
        D. Print shipping documents first and update serial/lot numbers later, if time permits.</label>
      <div>
        <button type="button" onclick="submitQuestion('q4')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q4')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q4"></div>
    </div>

    <!-- Q5 – Physical Count decision D2 -->
    <div class="question" data-qid="q5">
      <p class="q-text">
        <strong>Q5.</strong> Decision D2 asks “Require Physical Count?”.
        Why is this decision important in the Shipping Feedback SOP? :contentReference[oaicite:3]{index=3}
      </p>
      <label><input type="radio" name="q5" value="0">
        A. It determines which marketing flyer is added to the shipment.</label>
      <label><input type="radio" name="q5" value="1">
        B. It drives whether the product is flagged to be counted (S4), making sure someone physically verifies the on-hand quantity before shipping when needed.</label>
      <label><input type="radio" name="q5" value="2">
        C. It decides whether to split the order into multiple invoices.</label>
      <label><input type="radio" name="q5" value="3">
        D. It is only used to decide where paperwork is stored.</label>
      <div>
        <button type="button" onclick="submitQuestion('q5')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q5')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q5"></div>
    </div>

    <!-- Q6 – Entering quantity to be shipped -->
    <div class="question" data-qid="q6">
      <p class="q-text">
        <strong>Q6.</strong> Where in the SOP do you enter the quantity to be shipped,
        and why does it matter?
      </p>
      <label><input type="radio" name="q6" value="0">
        A. Only on the final invoice, after shipping is complete.</label>
      <label><input type="radio" name="q6" value="1">
        B. In S3 – Enter quantity to be shipped; this ensures that the system reflects the actual shipped quantity and that later shipping documents and invoices match what leaves the building.</label>
      <label><input type="radio" name="q6" value="2">
        C. By telling the driver verbally; no system entry is required.</label>
      <label><input type="radio" name="q6" value="3">
        D. In a separate spreadsheet that is not connected to the ERP system.</label>
      <div>
        <button type="button" onclick="submitQuestion('q6')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q6')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q6"></div>
    </div>

    <!-- Q7 – Apply Addons S7 -->
    <div class="question" data-qid="q7">
      <p class="q-text">
        <strong>Q7.</strong> Step S7 is “Apply Addons”.
        In the context of Shipping Feedback, what do “add-ons” usually refer to?
      </p>
      <label><input type="radio" name="q7" value="0">
        A. Adding extra items to the order that the customer did not request.</label>
      <label><input type="radio" name="q7" value="1">
        B. Adding personal notes from the warehouse staff.</label>
      <label><input type="radio" name="q7" value="2">
        C. Applying freight, handling charges, and other agreed add-on charges so that the order totals and invoice reflect the full cost of the shipment.</label>
      <label><input type="radio" name="q7" value="3">
        D. Adding marketing graphics to the invoice.</label>
      <div>
        <button type="button" onclick="submitQuestion('q7')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q7')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q7"></div>
    </div>

    <!-- Q8 – Complete Shipping Feedback Detail S8 -->
    <div class="question" data-qid="q8">
      <p class="q-text">
        <strong>Q8.</strong> What is the main goal of S8, “Complete the Shipping Feedback Detail,”
        before S9, “Ship the order”? :contentReference[oaicite:4]{index=4}
      </p>
      <label><input type="radio" name="q8" value="0">
        A. To print route sheets for drivers.</label>
      <label><input type="radio" name="q8" value="1">
        B. To make sure all shipping information is complete and correct—quantities, serial/lot numbers, flags for physical count, and add-ons—before the system treats the order as shipped.</label>
      <label><input type="radio" name="q8" value="2">
        C. To clear all previous shipping feedback entries.</label>
      <label><input type="radio" name="q8" value="3">
        D. To cancel any backorders on the order.</label>
      <div>
        <button type="button" onclick="submitQuestion('q8')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q8')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q8"></div>
    </div>

    <!-- Q9 – Ship the order vs Print documents S9/S10 -->
    <div class="question" data-qid="q9">
      <p class="q-text">
        <strong>Q9.</strong> In the SOP, S9 is “Ship the order” and S10 is
        “Print shipping documents”. Why are these two separate steps?
      </p>
      <label><input type="radio" name="q9" value="0">
        A. They are the same step; they only look different on paper.</label>
      <label><input type="radio" name="q9" value="1">
        B. S9 updates the system to show that the order has shipped (affecting inventory and future invoicing), while S10 prints the paperwork used by drivers, customers, and internal teams to support that shipment.</label>
      <label><input type="radio" name="q9" value="2">
        C. S9 is only for UPS orders and S10 is only for route trucks.</label>
      <label><input type="radio" name="q9" value="3">
        D. S9 is optional; only S10 is required.</label>
      <div>
        <button type="button" onclick="submitQuestion('q9')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q9')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q9"></div>
    </div>

    <!-- Q10 – Link to Pick to Invoice -->
    <div class="question" data-qid="q10">
      <p class="q-text">
        <strong>Q10.</strong> How does the Shipping Feedback SOP connect to the
        overall Pick to Invoice process?
      </p>
      <label><input type="radio" name="q10" value="0">
        A. It has no connection; Shipping Feedback is a separate process.</label>
      <label><input type="radio" name="q10" value="1">
        B. Accurate Shipping Feedback (S1–S10) provides the system data that the Pre-Invoice Exception Report and Invoice Processing steps rely on, so that invoices and inventory match what was actually shipped.</label>
      <label><input type="radio" name="q10" value="2">
        C. Shipping Feedback only updates marketing statistics and does not affect invoices.</label>
      <label><input type="radio" name="q10" value="3">
        D. Shipping Feedback is used only for warranty orders, not regular sales.</label>
      <div>
        <button type="button" onclick="submitQuestion('q10')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q10')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q10"></div>
    </div>
  </section>

  <section class="footer-actions">
    <p id="scoreSummary">Score will appear here after you submit at least one question.</p>
    <button type="button" onclick="calculateScore()">Calculate Score</button>
    <button type="button" onclick="downloadCsv()">Download Attempt Log (CSV)</button>
  </section>

  <script>
    // Global tracking
    const quizStart = new Date().toISOString();
    const questionIds = ["q1","q2","q3","q4","q5","q6","q7","q8","q9","q10"];
    const maxAttempts = 2;

    // Correct answers: index corresponds to value on each radio button
    const correctAnswers = {
      q1: 1, // Scott Electric description
      q2: 1, // Purpose of Shipping Feedback
      q3: 1, // S1->S2->S3
      q4: 1, // Serial/lot controlled -> S5/S6
      q5: 1, // Physical count decision
      q6: 1, // Enter quantity in S3
      q7: 2, // Apply add-ons = freight/handling etc.
      q8: 1, // Complete Shipping Feedback Detail purpose
      q9: 1, // Ship vs print docs
      q10: 1 // Link to Pick to Invoice
    };

    // Structure: { qid: { attempts: [ {...}, ... ], currentAttempt: {...}|null } }
    const responseLog = {};

    // Attach change listeners to all radios to capture start time / answer index
    document.querySelectorAll('input[type="radio"]').forEach(input => {
      input.addEventListener('change', handleOptionChange);
    });

    function handleOptionChange(event) {
      const qid = event.target.name;
      const answerIndex = parseInt(event.target.value, 10);
      const now = new Date().toISOString();

      if (!responseLog[qid]) {
        responseLog[qid] = { attempts: [], currentAttempt: null };
      }
      const qEntry = responseLog[qid];

      // If both attempts already used and no current attempt, do not allow changes
      if (!qEntry.currentAttempt && qEntry.attempts.length >= maxAttempts) {
        event.target.checked = false;
        const fb = document.getElementById(`feedback-${qid}`);
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "You have already used both attempts for this question.";
        }
        return;
      }

      if (!qEntry.currentAttempt) {
        // Start a new attempt
        qEntry.currentAttempt = {
          attemptNumber: qEntry.attempts.length + 1,
          startedAt: now,
          finishedAt: null,
          answerIndex: answerIndex,
          isCorrect: null
        };
      } else {
        // Update the chosen answer within the same attempt
        qEntry.currentAttempt.answerIndex = answerIndex;
      }
    }

    function submitQuestion(qid) {
      const now = new Date().toISOString();
      if (!responseLog[qid]) {
        responseLog[qid] = { attempts: [], currentAttempt: null };
      }
      const qEntry = responseLog[qid];
      const fb = document.getElementById(`feedback-${qid}`);

      // Ensure there is a selection
      const selected = document.querySelector(`input[name="${qid}"]:checked`);
      if (!selected) {
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "Please select an answer before submitting.";
        }
        return;
      }

      // If no current attempt, create one from the selected answer
      if (!qEntry.currentAttempt) {
        if (qEntry.attempts.length >= maxAttempts) {
          if (fb) {
            fb.classList.add("error");
            fb.textContent = "You have already used both attempts for this question.";
          }
          return;
        }
        qEntry.currentAttempt = {
          attemptNumber: qEntry.attempts.length + 1,
          startedAt: now,
          finishedAt: null,
          answerIndex: parseInt(selected.value, 10),
          isCorrect: null
        };
      }

      const attempt = qEntry.currentAttempt;

      if (attempt.finishedAt) {
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "This attempt has already been submitted.";
        }
        return;
      }

      attempt.finishedAt = now;
      attempt.isCorrect = (attempt.answerIndex === correctAnswers[qid]);
      qEntry.attempts.push(attempt);
      qEntry.currentAttempt = null;

      // Feedback
      if (fb) {
        fb.classList.remove("error");
        const attemptLabel = attempt.attemptNumber === 1 ? "First attempt" : "Second attempt";
        fb.textContent = `${attemptLabel}: ${attempt.isCorrect ? "Correct" : "Incorrect"} (started ${attempt.startedAt}, finished ${attempt.finishedAt}).`;
        if (qEntry.attempts.length >= maxAttempts) {
          fb.textContent += " You have used both attempts for this question.";
        }
      }

      // Optionally recalc score each submit
      calculateScore();
    }

    function redoQuestion(qid) {
      const qEntry = responseLog[qid];
      const fb = document.getElementById(`feedback-${qid}`);

      if (!qEntry || qEntry.attempts.length === 0) {
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "You must submit the question once before redoing it.";
        }
        return;
      }

      if (qEntry.attempts.length >= maxAttempts) {
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "You have already used your redo for this question.";
        }
        return;
      }

      // Clear selection
      document.querySelectorAll(`input[name="${qid}"]`).forEach(input => {
        input.checked = false;
      });

      qEntry.currentAttempt = null;

      if (fb) {
        fb.classList.remove("error");
        fb.textContent = "You may redo this question now. Make a new selection and click Submit Answer.";
      }
    }

    function calculateScore() {
      let correctCount = 0;
      let totalCount = questionIds.length;

      questionIds.forEach(qid => {
        const qEntry = responseLog[qid];
        if (!qEntry || qEntry.attempts.length === 0) {
          return;
        }
        const lastAttempt = qEntry.attempts[qEntry.attempts.length - 1];
        if (lastAttempt.isCorrect) {
          correctCount += 1;
        }
      });

      const scoreEl = document.getElementById("scoreSummary");
      if (scoreEl) {
        scoreEl.textContent = `Current score (based on your latest attempt for each question): ${correctCount} / ${totalCount}`;
      }
    }

    function downloadCsv() {
      const learnerName = (document.getElementById("learnerName").value || "").replace(/"/g, '""');
      const learnerEmail = (document.getElementById("learnerEmail").value || "").replace(/"/g, '""');
      const now = new Date().toISOString();

      const lines = [];
      lines.push('Quiz Name,"OPS – Shipping Feedback SOP – Knowledge Check"');
      lines.push(`Learner Name,"${learnerName}"`);
      lines.push(`Learner Email,"${learnerEmail}"`);
      lines.push(`Quiz Start,"${quizStart}"`);
      lines.push(`Log Generated At,"${now}"`);
      lines.push("");
      lines.push("Question ID,Question Text,Attempt #,Started At,Finished At,Answer Index,Answer Text,Correct?");

      questionIds.forEach(qid => {
        const qEntry = responseLog[qid];
        if (!qEntry || !qEntry.attempts || qEntry.attempts.length === 0) {
          return;
        }

        const qContainer = document.querySelector(`.question[data-qid="${qid}"]`);
        let qText = "";
        if (qContainer) {
          const qTextEl = qContainer.querySelector(".q-text");
          if (qTextEl) {
            qText = qTextEl.innerText.trim().replace(/"/g, '""');
          }
        }

        qEntry.attempts.forEach(att => {
          let answerText = "";
          const radio = document.querySelector(`input[name="${qid}"][value="${att.answerIndex}"]`);
          if (radio && radio.parentElement) {
            answerText = radio.parentElement.textContent.trim().replace(/"/g, '""');
          }
          const correctLabel = att.isCorrect ? "Yes" : "No";
          lines.push(
            `"${qid}","${qText}",${att.attemptNumber},` +
            `"${att.startedAt || ""}","${att.finishedAt || ""}",` +
            `${att.answerIndex},"${answerText}",${correctLabel}`
          );
        });
      });

      const csvContent = lines.join("\n");
      const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "OPS_Shipping_Feedback_Quiz_Attempts.csv";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
