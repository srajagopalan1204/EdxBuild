<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>OPS – Pick to Invoice SOP – Knowledge Check</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 1.5rem;
      line-height: 1.5;
      background: #f7f7fb;
    }
    h1, h2 {
      color: #111827;
    }
    .meta {
      margin-bottom: 1rem;
      padding: 0.75rem 1rem;
      background: #e5e7eb;
      border-radius: 6px;
    }
    .question {
      margin-bottom: 1.75rem;
      padding: 1rem 1.25rem;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    }
    .q-text {
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    label {
      display: block;
      margin: 0.15rem 0;
    }
    button {
      margin-top: 0.4rem;
      margin-right: 0.4rem;
      padding: 0.3rem 0.75rem;
      border-radius: 4px;
      border: 1px solid #4b5563;
      background: #111827;
      color: #ffffff;
      cursor: pointer;
      font-size: 0.9rem;
    }
    button.secondary {
      background: #ffffff;
      color: #111827;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .feedback {
      margin-top: 0.4rem;
      font-size: 0.85rem;
      color: #065f46;
    }
    .feedback.error {
      color: #b91c1c;
    }
    #scoreSummary {
      font-weight: 600;
      margin-top: 0.5rem;
      margin-bottom: 0.75rem;
    }
    .footer-actions {
      margin-top: 1.5rem;
      padding-top: 1rem;
      border-top: 1px solid #d1d5db;
    }
    input[type="text"], input[type="email"] {
      padding: 0.25rem 0.4rem;
      margin-right: 0.5rem;
      border-radius: 4px;
      border: 1px solid #9ca3af;
    }
  </style>
</head>
<body>
  <h1>OPS – Pick to Invoice SOP – Knowledge Check</h1>

  <div class="meta">
    <p>
      Please complete this quiz after you have gone through the
      <strong>OPS – Pick to Invoice</strong> SOP module.
      You may answer each question up to <strong>two times</strong>. Your attempts and timestamps
      will be captured in a CSV log you can download at the end.
    </p>
    <p>
      <em>Note:</em> Question 1 is about the history and mission of Scott Electric.
      Questions 2–10 are about the Pick to Invoice process.
    </p>
  </div>

  <section>
    <h2>Learner Information</h2>
    <p>
      <label>
        Your Name:
        <input type="text" id="learnerName" placeholder="Type your name">
      </label>
      <label>
        Your Email:
        <input type="email" id="learnerEmail" placeholder="name@example.com">
      </label>
    </p>
  </section>

  <section id="quiz">
    <h2>Quiz Questions</h2>

    <!-- Q1 – Scott Electric history -->
    <div class="question" data-qid="q1">
      <p class="q-text">
        <strong>Q1.</strong> Which statement best describes Scott Electric’s history and role
        in the markets it serves?
      </p>
      <label><input type="radio" name="q1" value="0">
        A. Scott Electric is a new startup founded in the last few years that only serves one small town.</label>
      <label><input type="radio" name="q1" value="1">
        B. Scott Electric is a long-established, employee-owned regional wholesale electrical distributor headquartered in Greensburg, Pennsylvania, with multiple branches and divisions serving customers in several states.</label>
      <label><input type="radio" name="q1" value="2">
        C. Scott Electric is a software company that only provides online ordering systems to other distributors.</label>
      <label><input type="radio" name="q1" value="3">
        D. Scott Electric is a small residential electrical contractor with no distribution operations.</label>
      <div>
        <button type="button" onclick="submitQuestion('q1')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q1')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q1"></div>
    </div>

    <!-- Q2 – Start of Pick→Invoice -->
    <div class="question" data-qid="q2">
      <p class="q-text">
        <strong>Q2.</strong> Where does the <em>Pick to Invoice</em> SOP begin in the overall
        order flow?
      </p>
      <label><input type="radio" name="q2" value="0">
        A. When the customer’s quote is first entered.</label>
      <label><input type="radio" name="q2" value="1">
        B. After the pick ticket has been created and printed in the warehouse (S1).</label>
      <label><input type="radio" name="q2" value="2">
        C. After the invoice has already been sent to the customer.</label>
      <label><input type="radio" name="q2" value="3">
        D. Only when a collections issue arises.</label>
      <div>
        <button type="button" onclick="submitQuestion('q2')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q2')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q2"></div>
    </div>

    <!-- Q3 – S1/S2/S3 flow -->
    <div class="question" data-qid="q3">
      <p class="q-text">
        <strong>Q3.</strong> Which sequence best describes the early physical steps
        in the Pick to Invoice SOP?
      </p>
      <label><input type="radio" name="q3" value="0">
        A. S1 – Invoice to Customer &rarr; S2 – Orders Picked and Staged &rarr; S3 – Shipping Verification and Packing.</label>
      <label><input type="radio" name="q3" value="1">
        B. S1 – Pick Ticket Printed in Warehouse &rarr; S2 – Orders Picked and Staged (Packed) &rarr; S3 – Shipping Verification and Packing.</label>
      <label><input type="radio" name="q3" value="2">
        C. S1 – Run Pre-Invoice Exception Report &rarr; S2 – Invoice Processing &rarr; S3 – Shipping Feedback.</label>
      <label><input type="radio" name="q3" value="3">
        D. S1 – Customer Pickup &rarr; S2 – DQT Proof of Delivery &rarr; S3 – Run Invoice Processing.</label>
      <div>
        <button type="button" onclick="submitQuestion('q3')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q3')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q3"></div>
    </div>

    <!-- Q4 – Shipping feedback bins -->
    <div class="question" data-qid="q4">
      <p class="q-text">
        <strong>Q4.</strong> The SOP shows two different shipping feedback steps:
        S4 (no change) and S11 (some change), each with separate paperwork bins.
        Why are the two bins important?
      </p>
      <label><input type="radio" name="q4" value="0">
        A. One bin is for warehouse, and the other is for recycling scrap.</label>
      <label><input type="radio" name="q4" value="1">
        B. They visually separate shipments where quantities or lines match the original order (no change) from those where there were changes, so that exceptions and billing issues can be handled correctly.</label>
      <label><input type="radio" name="q4" value="2">
        C. One bin is for UPS shipments only, and the other is for all truck routes.</label>
      <label><input type="radio" name="q4" value="3">
        D. There is no real difference; the bins are just a space saver.</label>
      <div>
        <button type="button" onclick="submitQuestion('q4')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q4')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q4"></div>
    </div>

    <!-- Q5 – Customer pickup / dispatch -->
    <div class="question" data-qid="q5">
      <p class="q-text">
        <strong>Q5.</strong> In step S5, “Customer Pickup or Dispatch by UPS etc.”,
        what is the key control for the Pick to Invoice process?
      </p>
      <label><input type="radio" name="q5" value="0">
        A. Ensuring that every shipment has a promotional flyer included.</label>
      <label><input type="radio" name="q5" value="1">
        B. Making sure the method of delivery (pickup, UPS, route truck, etc.) and any proof-of-delivery requirements are followed so that shipping feedback and invoicing will match what actually left the building.</label>
      <label><input type="radio" name="q5" value="2">
        C. Recording only the truck number and ignoring quantities.</label>
      <label><input type="radio" name="q5" value="3">
        D. Skipping any documentation when the customer is in a hurry.</label>
      <div>
        <button type="button" onclick="submitQuestion('q5')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q5')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q5"></div>
    </div>

    <!-- Q6 – DQT Proof of Delivery -->
    <div class="question" data-qid="q6">
      <p class="q-text">
        <strong>Q6.</strong> What is the purpose of S10, “DQT Proof of Delivery,”
        in the Pick to Invoice SOP?
      </p>
      <label><input type="radio" name="q6" value="0">
        A. To print a second pick ticket for the same order.</label>
      <label><input type="radio" name="q6" value="1">
        B. To confirm that delivery occurred as expected and to capture proof (such as signed documents) that supports exception handling and invoicing.</label>
      <label><input type="radio" name="q6" value="2">
        C. To cancel the order if the driver is late.</label>
      <label><input type="radio" name="q6" value="3">
        D. To move all paperwork to recycling after invoicing.</label>
      <div>
        <button type="button" onclick="submitQuestion('q6')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q6')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q6"></div>
    </div>

    <!-- Q7 – Pre-invoice exception report -->
    <div class="question" data-qid="q7">
      <p class="q-text">
        <strong>Q7.</strong> Why does the SOP include S6, “Run Pre-Invoice Exception Report,”
        before invoice processing?
      </p>
      <label><input type="radio" name="q7" value="0">
        A. To generate marketing statistics for the Sales team.</label>
      <label><input type="radio" name="q7" value="1">
        B. To identify orders with problems (such as missing shipping feedback, quantity or line changes, or other mismatches) so they can be reviewed and corrected before invoices are created.</label>
      <label><input type="radio" name="q7" value="2">
        C. To automatically close all open orders, whether shipped or not.</label>
      <label><input type="radio" name="q7" value="3">
        D. To print daily route sheets for drivers.</label>
      <div>
        <button type="button" onclick="submitQuestion('q7')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q7')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q7"></div>
    </div>

    <!-- Q8 – Review and take action -->
    <div class="question" data-qid="q8">
      <p class="q-text">
        <strong>Q8.</strong> In S9, “Review and Take Appropriate Action,” who typically
        uses the pre-invoice exception report and what do they do with it?
      </p>
      <label><input type="radio" name="q8" value="0">
        A. Warehouse staff use it only to count how many orders shipped that day.</label>
      <label><input type="radio" name="q8" value="1">
        B. The appropriate supervisor or billing staff review each exception, verify shipping paperwork and feedback, correct any errors (quantities, pricing, terms, etc.), and only then clear the order for invoicing.</label>
      <label><input type="radio" name="q8" value="2">
        C. Drivers use it to decide where to take their lunch break.</label>
      <label><input type="radio" name="q8" value="3">
        D. It is automatically filed without review.</label>
      <div>
        <button type="button" onclick="submitQuestion('q8')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q8')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q8"></div>
    </div>

    <!-- Q9 – Invoice processing vs invoice to cash -->
    <div class="question" data-qid="q9">
      <p class="q-text">
        <strong>Q9.</strong> What is the relationship between S7, “Run Invoice Processing,”
        and S8, “Invoice to Cash / Invoice to Customer”?
      </p>
      <label><input type="radio" name="q9" value="0">
        A. S7 is a purely cosmetic step; only S8 matters.</label>
      <label><input type="radio" name="q9" value="1">
        B. S7 creates and posts invoices in the system for all orders that have passed the exception review, and S8 covers sending invoices to customers and moving the process into the cash-collection stage.</label>
      <label><input type="radio" name="q9" value="2">
        C. S7 cancels invoices and S8 recreates them.</label>
      <label><input type="radio" name="q9" value="3">
        D. S7 is only used for quotes; S8 is used for orders.</label>
      <div>
        <button type="button" onclick="submitQuestion('q9')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q9')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q9"></div>
    </div>

    <!-- Q10 – Role of Infor Process Intelligence / overall flow -->
    <div class="question" data-qid="q10">
      <p class="q-text">
        <strong>Q10.</strong> The creator of the Pick to Invoice SOP notes that
        Infor’s “Process Intelligence” helped define and verify the process.
        What does this mean for how you should use this SOP day-to-day?
      </p>
      <label><input type="radio" name="q10" value="0">
        A. The SOP is optional; every user should make up their own way of handling pick tickets and invoicing.</label>
      <label><input type="radio" name="q10" value="1">
        B. The steps in the SOP are based on actual Infor system flows and data, so following them closely helps ensure that physical movements (picking, packing, shipping) and system steps (feedback, exceptions, invoicing) stay aligned.</label>
      <label><input type="radio" name="q10" value="2">
        C. Only the warehouse uses this SOP; billing and customer service do not need to care about it.</label>
      <label><input type="radio" name="q10" value="3">
        D. The SOP is only for training and should not be used once the system is live.</label>
      <div>
        <button type="button" onclick="submitQuestion('q10')">Submit Answer</button>
        <button type="button" class="secondary" onclick="redoQuestion('q10')">Redo Question</button>
      </div>
      <div class="feedback" id="feedback-q10"></div>
    </div>
  </section>

  <section class="footer-actions">
    <p id="scoreSummary">Score will appear here after you submit at least one question.</p>
    <button type="button" onclick="calculateScore()">Calculate Score</button>
    <button type="button" onclick="downloadCsv()">Download Attempt Log (CSV)</button>
  </section>

  <script>
    // Global tracking
    const quizStart = new Date().toISOString();
    const questionIds = ["q1","q2","q3","q4","q5","q6","q7","q8","q9","q10"];
    const maxAttempts = 2;

    // Correct answers: index corresponds to value attribute on each radio button
    const correctAnswers = {
      q1: 1, // Scott Electric history/role
      q2: 1, // Starts after pick ticket printed
      q3: 1, // S1->S2->S3 sequence
      q4: 1, // Two bins separate no-change vs change shipments
      q5: 1, // Delivery method / POD control
      q6: 1, // DQT Proof of Delivery purpose
      q7: 1, // Pre-invoice exception report purpose
      q8: 1, // Supervisor/billing review and correct
      q9: 1, // Invoice processing vs invoice to cash
      q10: 1 // Process Intelligence implies follow SOP as system-backed
    };

    // Structure: { qid: { attempts: [ {...}, ... ], currentAttempt: {...}|null } }
    const responseLog = {};

    // Attach change listeners to all radios to capture start time / answer index
    document.querySelectorAll('input[type="radio"]').forEach(input => {
      input.addEventListener('change', handleOptionChange);
    });

    function handleOptionChange(event) {
      const qid = event.target.name;
      const answerIndex = parseInt(event.target.value, 10);
      const now = new Date().toISOString();

      if (!responseLog[qid]) {
        responseLog[qid] = { attempts: [], currentAttempt: null };
      }
      const qEntry = responseLog[qid];

      // If both attempts already used and no current attempt, do not allow changes
      if (!qEntry.currentAttempt && qEntry.attempts.length >= maxAttempts) {
        event.target.checked = false;
        const fb = document.getElementById(`feedback-${qid}`);
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "You have already used both attempts for this question.";
        }
        return;
      }

      if (!qEntry.currentAttempt) {
        // Start a new attempt
        qEntry.currentAttempt = {
          attemptNumber: qEntry.attempts.length + 1,
          startedAt: now,
          finishedAt: null,
          answerIndex: answerIndex,
          isCorrect: null
        };
      } else {
        // Update the chosen answer within the same attempt
        qEntry.currentAttempt.answerIndex = answerIndex;
      }
    }

    function submitQuestion(qid) {
      const now = new Date().toISOString();
      if (!responseLog[qid]) {
        responseLog[qid] = { attempts: [], currentAttempt: null };
      }
      const qEntry = responseLog[qid];
      const fb = document.getElementById(`feedback-${qid}`);

      // Ensure there is a selection
      const selected = document.querySelector(`input[name="${qid}"]:checked`);
      if (!selected) {
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "Please select an answer before submitting.";
        }
        return;
      }

      // If no current attempt, create one from the selected answer
      if (!qEntry.currentAttempt) {
        if (qEntry.attempts.length >= maxAttempts) {
          if (fb) {
            fb.classList.add("error");
            fb.textContent = "You have already used both attempts for this question.";
          }
          return;
        }
        qEntry.currentAttempt = {
          attemptNumber: qEntry.attempts.length + 1,
          startedAt: now,
          finishedAt: null,
          answerIndex: parseInt(selected.value, 10),
          isCorrect: null
        };
      }

      const attempt = qEntry.currentAttempt;

      if (attempt.finishedAt) {
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "This attempt has already been submitted.";
        }
        return;
      }

      attempt.finishedAt = now;
      attempt.isCorrect = (attempt.answerIndex === correctAnswers[qid]);
      qEntry.attempts.push(attempt);
      qEntry.currentAttempt = null;

      // Feedback
      if (fb) {
        fb.classList.remove("error");
        const attemptLabel = attempt.attemptNumber === 1 ? "First attempt" : "Second attempt";
        fb.textContent = `${attemptLabel}: ${attempt.isCorrect ? "Correct" : "Incorrect"} (started ${attempt.startedAt}, finished ${attempt.finishedAt}).`;
        if (qEntry.attempts.length >= maxAttempts) {
          fb.textContent += " You have used both attempts for this question.";
        }
      }

      // Optionally recalc score each submit
      calculateScore();
    }

    function redoQuestion(qid) {
      const qEntry = responseLog[qid];
      const fb = document.getElementById(`feedback-${qid}`);

      if (!qEntry || qEntry.attempts.length === 0) {
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "You must submit the question once before redoing it.";
        }
        return;
      }

      if (qEntry.attempts.length >= maxAttempts) {
        if (fb) {
          fb.classList.add("error");
          fb.textContent = "You have already used your redo for this question.";
        }
        return;
      }

      // Clear selection
      document.querySelectorAll(`input[name="${qid}"]`).forEach(input => {
        input.checked = false;
      });

      qEntry.currentAttempt = null;

      if (fb) {
        fb.classList.remove("error");
        fb.textContent = "You may redo this question now. Make a new selection and click Submit Answer.";
      }
    }

    function calculateScore() {
      let correctCount = 0;
      let totalCount = questionIds.length;

      questionIds.forEach(qid => {
        const qEntry = responseLog[qid];
        if (!qEntry || qEntry.attempts.length === 0) {
          return;
        }
        const lastAttempt = qEntry.attempts[qEntry.attempts.length - 1];
        if (lastAttempt.isCorrect) {
          correctCount += 1;
        }
      });

      const scoreEl = document.getElementById("scoreSummary");
      if (scoreEl) {
        scoreEl.textContent = `Current score (based on your latest attempt for each question): ${correctCount} / ${totalCount}`;
      }
    }

    function downloadCsv() {
      const learnerName = (document.getElementById("learnerName").value || "").replace(/"/g, '""');
      const learnerEmail = (document.getElementById("learnerEmail").value || "").replace(/"/g, '""');
      const now = new Date().toISOString();

      const lines = [];
      lines.push('Quiz Name,"OPS – Pick to Invoice SOP – Knowledge Check"');
      lines.push(`Learner Name,"${learnerName}"`);
      lines.push(`Learner Email,"${learnerEmail}"`);
      lines.push(`Quiz Start,"${quizStart}"`);
      lines.push(`Log Generated At,"${now}"`);
      lines.push("");
      lines.push("Question ID,Question Text,Attempt #,Started At,Finished At,Answer Index,Answer Text,Correct?");

      questionIds.forEach(qid => {
        const qEntry = responseLog[qid];
        if (!qEntry || !qEntry.attempts || qEntry.attempts.length === 0) {
          return;
        }

        const qContainer = document.querySelector(`.question[data-qid="${qid}"]`);
        let qText = "";
        if (qContainer) {
          const qTextEl = qContainer.querySelector(".q-text");
          if (qTextEl) {
            qText = qTextEl.innerText.trim().replace(/"/g, '""');
          }
        }

        qEntry.attempts.forEach(att => {
          let answerText = "";
          const radio = document.querySelector(`input[name="${qid}"][value="${att.answerIndex}"]`);
          if (radio && radio.parentElement) {
            answerText = radio.parentElement.textContent.trim().replace(/"/g, '""');
          }
          const correctLabel = att.isCorrect ? "Yes" : "No";
          lines.push(
            `"${qid}","${qText}",${att.attemptNumber},` +
            `"${att.startedAt || ""}","${att.finishedAt || ""}",` +
            `${att.answerIndex},"${answerText}",${correctLabel}`
          );
        });
      });

      const csvContent = lines.join("\n");
      const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "OPS_Pick_to_Invoice_Quiz_Attempts.csv";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
